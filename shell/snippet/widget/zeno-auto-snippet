#autoload

if [[ ! -z $ZENO_ENABLE_SOCK ]]; then
  local out=$(zeno-client "--mode=auto-snippet $LBUFFER\n$RBUFFER")
else
  local out=$(echo "$LBUFFER\n$RBUFFER" | zeno --mode=auto-snippet)
fi

if [[ $(echo "$out" | head -1) != "success" ]]; then
  LBUFFER+=" "
  return
fi

local buffer=$(echo "$out" | head -2 | tail -1)
local cursor=$(echo "$out" | head -3 | tail -1)

if [[ $buffer != "" ]]; then
  BUFFER=$buffer
  CURSOR=$cursor
fi

zle reset-prompt
