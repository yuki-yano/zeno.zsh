#autoload

local tokens=(${(z)LBUFFER})

if [[ $#tokens != 1 ]]; then
  zle accept-line
  return
fi

local out=$(echo "$LBUFFER\n$RBUFFER" | zeno --mode=auto-snippet)

if [[ $(echo "$out" | head -1) != "success" ]]; then
  zle accept-line
  return
fi

local buffer=$(echo "$out" | head -2 | tail -1)

if [[ $buffer != "" ]]; then
  BUFFER=$buffer
  zle accept-line
fi
